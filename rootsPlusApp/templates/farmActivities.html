{% extends 'base.html' %}
{% block title %}Farm Activities – {{ farm.name }}{% endblock %}

{% block content %}
<div class="container py-4">

    <!-- Django Messages -->
    {% if messages %}
    {% for message in messages %}
    <div class="alert alert-{% if message.tags == 'error' %}danger{% else %}{{ message.tags }}{% endif %} 
                    alert-dismissible fade show mb-3 mx-auto w-100 w-md-75" role="alert">
        <i class="bi bi-info-circle me-2"></i> {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endfor %}
    {% endif %}
    <!-- End Django Messages -->


    <div
        class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-4 gap-3">
        <h4 class="mb-0">

            All Activities for {{ farm.name }}
        </h4>

        <div class="d-flex flex-column flex-md-row gap-2 w-50 w-md-auto justify-content-end ms-auto">
            {% if role == 'agronomist' and farm and farm.id %}
            <a href="{% url 'rootsPlusApp:add_activity' farm.id %}" class="btn btn-sm btn-warning">
                <i class="bi bi-plus-circle me-1"></i> Add New Activity
            </a>
            {% endif %}
            <a href="{% url 'rootsPlusApp:farm_detail' farm.id %}" class="btn btn-outline-secondary btn-sm">
                <i class="bi bi-arrow-left-circle me-1"></i> Back to Farm Details
            </a>
        </div>
    </div>
    < {% if activities %} <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle text-center">
            <thead class="table-light">
                <tr>
                    <th>#</th>
                    <th><i class="bi bi-list-task me-1"></i> Type</th>
                    <th style="width: 150px;"><i class="bi bi-flower1 me-1"></i> Crop</th>
                    <th><i class="bi bi-calendar-event me-1"></i> Date</th>
                    <th><i class="bi bi-person-badge me-1"></i> Agronomist</th>
                    <th><i class="bi bi-card-text me-1"></i> Notes</th>
                </tr>
            </thead>
            <tbody>
                {% for activity in activities %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{{ activity.get_activity_type_display }}</td>
                    <td>{{ activity.crop.crop_name }}</td>
                    <td>{{ activity.date|date:"Y-m-d H:i" }}</td>
                    <td>{{ activity.agronomist.name }}</td>
                    <td class="text-start">{{ activity.notes|default:"—"|linebreaksbr }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
</div>
{% else %}
<div class="alert alert-info d-flex align-items-center" role="alert">
    <i class="bi bi-info-circle me-2"></i>
    No activities recorded for this farm yet.
</div>
{% endif %}


</div>
{% endblock %}